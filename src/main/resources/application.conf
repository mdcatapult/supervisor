admin {
  port = 9090
  port = ${?ADMIN_PORT}
}

akka {
  loggers = ["akka.event.slf4j.Slf4jLogger"]
  loglevel = "ERROR"
  stdout-loglevel = "ERROR"
  logging-filter = "akka.event.slf4j.Slf4jLoggingFilter"
}

op-rabbit {
  topic-exchange-name = ${?RABBITMQ_DOCLIB_EXCHANGE}
  channel-dispatcher = "op-rabbit.default-channel-dispatcher"
  default-channel-dispatcher {
    type = Dispatcher
    executor = "fork-join-executor"
    fork-join-executor {
      parallelism-min = 2
      parallelism-factor = 2.0
      parallelism-max = 4
    }
    throughput = 1
  }
  connection {
    virtual-host = "doclib"
    virtual-host = ${?RABBITMQ_VHOST}
    hosts = [${?RABBITMQ_HOST}]
    username = "doclib"
    username = ${?RABBITMQ_USERNAME}
    password = "doclib"
    password = ${?RABBITMQ_PASSWORD}
    port = 5672
    port = ${?RABBITMQ_PORT}
    ssl = false
    connection-timeout = 3s
  }
}

mongo {
  doclib-database = "doclib"
  doclib-database = ${?MONGO_DOCLIB_DATABASE}
  documents-collection = "documents"
  documents-collection = ${?MONGO_DOCUMENTS_COLLECTION}
  connection {
    hosts = [${?MONGO_HOST}]
    username = "doclib"
    username = ${?MONGO_USERNAME}
    password = "doclib"
    password = ${?MONGO_PASSWORD}
    port = 27017
    port = ${?MONGO_PORT}
    database = "admin"
    database = ${?MONGO_AUTHSOURCE}
  }
  read-limit = 100
  read-limit = ${?MONGO_READ_LIMIT}
  write-limit = 50
  write-limit = ${?MONGO_WRITE_LIMIT}
}

consumer {
  name: "supervisor"
  name: ${?CONSUMER_NAME}
  concurrency: 1
  concurrency: ${?CONSUMER_CONCURRENT}
  queue: "supervisor"
  queue: ${?DOCLIB_SUPERVISOR_QUEUE}
  queue: ${?CONSUMER_QUEUE}
}

doclib {}


supervisor {
  archive: {
    required: [{
      flag: "unarchiver"
      flag: ${?DOCLIB_ARCHIVE_FLAG}
      route: "unarchive"
      route: ${?DOCLIB_ARCHIVE_QUEUE}
      type: "queue"
    }]
  }
  tabular: {
    totsv: {
      required: [{
        flag: "tabular.totsv"
        flag: ${?DOCLIB_SPREADSHEET_CONVERTER_FLAG}
        route: "tabular.totsv"
        route: ${?DOCLIB_SPREADSHEET_CONVERTER_QUEUE}
        type: "queue"
      }]
    }
    analyse {
      required: [{
        flag: "tabular.analysis"
        route: "tabular.analysis"
        type: "queue"
      }]
    }
  }
  html: {
    required: [{
      flag: "html.screenshot"
      route: "html.screenshot"
      type: "queue"
    },{
      flag: "html.render"
      route: "html.render"
      type: "queue"
    }]
  }
  xml: {
    required: []
  }
  text: {
      required: [{
        flag: "rawtext"
        flag: ${?DOCLIB_RAWTEXT_CONVERTER_FLAG}
        route: "rawtext"
        route: ${?DOCLIB_RAWTEXT_CONVERTER_QUEUE}
        type: "queue"
      }]
  }
  image_intermediate: {
      required: [{
        flag: "pdf.intermediates"
        route: "pdf.intermediates"
        type: "queue"
      }]
  }
  bounding_box: {
      required: [{
        flag: "bounding_box"
        route: "pdf.figures"
        type: "queue"
      }]
  }
  analytical: {
      required: [{
        flag: "analytical.supervisor"
        route: "analytical.supervisor"
        type: "queue"
      }]
  }
  document: {
    required: []
  }
  chemical: {
    required: []
  }
  image: {
    required: []
  }
  audio: {
    required: []
  }
  video: {
    required: []
  }
  ner: {
    required: [{
      flag: "ner.leadmine.chemblactivityterms"
      flag: ${?DOCLIB_LEADMINE_CHEMBLACTIVITYTERMS_FLAG}
      route: "ner.leadmine.chemblactivityterms"
      route: ${?DOCLIB_LEADMINE_CHEMBLACTIVITYTERMS_QUEUE}
      type: "queue"
    },{
      flag: "ner.leadmine.chemicalentities"
      flag: ${?DOCLIB_LEADMINE_CHEMICALENTITIES_FLAG}
      route: "ner.leadmine.chemicalentities"
      route: ${?DOCLIB_LEADMINE_CHEMICALENTITIES_QUEUE}
      type: "queue"
    },{
      flag: "ner.leadmine.chemicalidentifiers"
      flag: ${?DOCLIB_LEADMINE_CHEMICALIDENTIFIERS_FLAG}
      route: "ner.leadmine.chemicalidentifiers"
      route: ${?DOCLIB_LEADMINE_CHEMICALIDENTIFIERS_QUEUE}
      type: "queue"
    },{
      flag: "ner.leadmine.poseidon"
      flag: ${?DOCLIB_LEADMINE_POSEIDON_FLAG}
      route: "ner.leadmine.poseidon"
      route: ${?DOCLIB_LEADMINE_POSEIDON_QUEUE}
      type: "queue"
    }]
  }
}

analytical: {
  supervisor: false
  supervisor: ${?ANALYTICAL_SUPERVISOR}
}